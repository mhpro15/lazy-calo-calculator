// Prisma schema for Lazy Calo
// Stores scenarios/questions/options so you can add foods without shipping new code.

datasource db {
  provider  = "postgresql"
}

generator client {
  provider = "prisma-client-js"
}

model Scenario {
  id        String            @id @default(cuid())
  slug      String            @unique
  title     String
  // Maps to a lucide icon on the client ("Pizza", "Hamburger", "Salad", "Coffee", "Utensils")
  iconKey   String
  keywords  ScenarioKeyword[]
  questions Question[]
  createdAt DateTime          @default(now())
  updatedAt DateTime          @updatedAt
}

model ScenarioKeyword {
  id         String   @id @default(cuid())
  scenarioId String
  value      String
  scenario   Scenario @relation(fields: [scenarioId], references: [id], onDelete: Cascade)

  @@unique([scenarioId, value])
  @@index([value])
}

model Question {
  id         String   @id @default(cuid())
  scenarioId String
  key        String
  text       String
  order      Int
  options    Option[]
  scenario   Scenario @relation(fields: [scenarioId], references: [id], onDelete: Cascade)

  @@unique([scenarioId, key])
  @@index([scenarioId, order])
}

model Option {
  id         String   @id @default(cuid())
  questionId String
  label      String
  value      Int
  order      Int
  question   Question @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@index([questionId, order])
}
